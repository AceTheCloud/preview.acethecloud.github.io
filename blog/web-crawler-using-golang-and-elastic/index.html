<!doctype html><html><head><meta charset=utf-8><title>Using GoLang and Elasticsearch to Crawl and Analyze Amazon.com Data 👨🏼‍💻</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><link rel=stylesheet href=https://AceTheOps.com/plugins/slick/slick.css><link rel=stylesheet href=https://AceTheOps.com/plugins/slick/slick-theme.css><link rel=stylesheet href=https://AceTheOps.com/plugins/font-awesome/css/font-awesome.min.css><link rel=stylesheet href=https://AceTheOps.com/plugins/magnafic-popup/magnific-popup.css><link href=https://AceTheOps.com/scss/style.min.css rel=stylesheet><link rel="shortcut icon" href=https://AceTheOps.com/images/favicon.ico type=image/x-icon><link rel=icon href=https://AceTheOps.com/images/favicon.png type=image/x-icon><script async src="https://www.googletagmanager.com/gtag/js?id=G-FCQTR1NVY6"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-FCQTR1NVY6")</script></head><body><nav class="navbar navbar-expand-lg fixed-top"><div class=container><a href=https://AceTheOps.com/ class=navbar-brand><img src=https://AceTheOps.com/images/site-navigation/logo.png alt=site-logo></a>
<button type=button class="navbar-toggler collapsed" data-toggle=collapse data-target=#navbarCollapse>
<span class=navbar-toggler-icon></span>
<span class=navbar-toggler-icon></span>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse justify-content-between" id=navbarCollapse><ul class="nav navbar-nav main-navigation my-0 mx-auto"><li class=nav-item><a href=https://AceTheOps.com/#home class="nav-link text-dark text-sm-center p-2">Home</a></li><li class=nav-item><a href=https://AceTheOps.com/#about class="nav-link text-dark text-sm-center p-2">About</a></li><li class=nav-item><a href=https://AceTheOps.com/#service class="nav-link text-dark text-sm-center p-2">Service</a></li><li class=nav-item><a href=https://AceTheOps.com/#portfolio class="nav-link text-dark text-sm-center p-2">Work</a></li><li class=nav-item><a href=https://AceTheOps.com/#resume class="nav-link text-dark text-sm-center p-2">Resume</a></li><li class=nav-item><a href=https://AceTheOps.com/#skills class="nav-link text-dark text-sm-center p-2">Skills</a></li><li class=nav-item><a href=https://AceTheOps.com/#contact class="nav-link text-dark text-sm-center p-2">Contact</a></li></ul><div class=navbar-nav><a href=https://AceTheOps.com/blog class="btn btn-primary btn-zoom hire_button">Blog</a></div></div></div></nav><div id=content><header class=breadCrumb><div class=container><div class=row><div class="col-lg-10 col-md-12 offset-lg-1 offset-md-0 text-center"><h3 class=breadCrumb__title>Using GoLang and Elasticsearch to Crawl and Analyze Amazon.com Data 👨🏼‍💻</h3><nav aria-label=breadcrumb class="d-flex justify-content-center"><ol class="breadcrumb align-items-center"><li class=breadcrumb-item><a href=https://AceTheOps.com/>Home</a></li><li class=breadcrumb-item><a href=https://AceTheOps.com/blog>All Post</a></li><li class="breadcrumb-item active" aria-current=page>Using GoLang and Elasticsearch to Crawl and Analyze Amazon.com Data 👨🏼‍💻</li></ol></nav></div></div><ul class=post-meta><li><i class="fa fa-calendar"></i>
December 21, 2022</li><li><i class="fa fa-clock-o"></i>
5 mins read</li><li><i class="fa fa-tag"></i>
<a class=text-capitalize href=https://AceTheOps.com/tags/go-lang/>go-lang</a>
<a class=text-capitalize href=https://AceTheOps.com/tags/elastic/>elastic</a>
<a class=text-capitalize href=https://AceTheOps.com/tags/crawler/>crawler</a></li><li><i class="fa fa-folder-open"></i>
<a class=text-capitalize href=https://AceTheOps.com/categories/blog/>blog</a></li></ul></div></div></div></div></header><section class="section singleBlog"><div class=svg-img><img src=https://AceTheOps.com/images/hero/figure-svg.svg alt></div><div class=animate-shape><img src=https://AceTheOps.com/images/skill/skill-background-shape.svg alt><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 600 600"><defs><linearGradient id="d" x1=".929" y1=".111" x2=".263" y2=".935" gradientUnits="objectBoundingBox"><stop offset="0" stop-color="#f1f6f9"/><stop offset="1" stop-color="#f1f6f9" stop-opacity="0"/></linearGradient></defs><g data-name="blob-shape (3)"><path class="blob" fill="url(#d)" d="M455.4 151.1c43.1 36.7 73.4 92.8 60.8 136.3-12.7 43.5-68.1 74.4-111.3 119.4-43.1 45-74 104.1-109.8 109-35.9 5-76.7-44.2-111.8-89.2-35.2-45-64.7-85.8-70.8-132.6-6-46.8 11.6-99.6 46.7-136.3 35.2-36.6 88-57.2 142.4-58.8 54.5-1.7 110.6 15.6 153.8 52.2z"/></g></svg></div><div class=animate-pattern><img src=https://AceTheOps.com/images/service/background-pattern.svg alt=background-shape></div><div class=container><div class=row><div class=col-lg-12><div class=singleBlog__feature><img src=https://AceTheOps.com/ alt=feature-image></div></div></div><div class="row mt-5"><div class=col-lg-12><div class=singleBlog__content><p>Golang, or Go, is a programming language that is known for its simplicity, concurrency support, and efficient memory management. Concurrency in Go allows developers to write programs that can perform multiple tasks concurrently, allowing for faster and more efficient execution.</p><p>Crawling Amazon.com and storing the data in Elasticsearch using GoLang is a common use case for web crawlers. Elasticsearch is a popular search engine that can be used to store and search large amounts of data, making it an ideal choice for storing the results of a web crawl. In this blog post, we will learn how to build a web crawler for Amazon.com using GoLang and store the data in Elasticsearch.</p><p>To get started, we will need to install and set up Elasticsearch on our machine. You can find instructions for doing this in the Elasticsearch documentation.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;net/http&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;io/ioutil&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;golang.org/x/net/html&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;github.com/olivere/elastic&#34;</span>
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><p>The &ldquo;fmt&rdquo; and &ldquo;net/http&rdquo; packages are used for printing messages and making HTTP requests, the &ldquo;io/ioutil&rdquo; package is used for reading the response from the server, the &ldquo;html&rdquo; package is used for parsing the HTML content, and the &ldquo;elastic&rdquo; package is used for interacting with Elasticsearch.</p><p>Next, we will define a function to connect to Elasticsearch:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>connectToElasticsearch</span>() <span style=color:#f92672>*</span><span style=color:#a6e22e>elastic</span>.<span style=color:#a6e22e>Client</span> {
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Set the Elasticsearch URL
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>url</span> <span style=color:#f92672>:=</span> <span style=color:#e6db74>&#34;http://localhost:9200&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Create a new Elasticsearch client
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>client</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>elastic</span>.<span style=color:#a6e22e>NewClient</span>(<span style=color:#a6e22e>elastic</span>.<span style=color:#a6e22e>SetURL</span>(<span style=color:#a6e22e>url</span>))
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Return the client
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>client</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>In this function, we set the URL of our Elasticsearch instance and create a new Elasticsearch client using the &ldquo;elastic&rdquo; package. We then return the client to be used in other functions.</p><p>Next, let&rsquo;s define the main function of our web crawler:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Set the starting URL
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>url</span> <span style=color:#f92672>:=</span> <span style=color:#e6db74>&#34;https://www.amazon.com/products&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Make an HTTP GET request to the URL
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>response</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Get</span>(<span style=color:#a6e22e>url</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>defer</span> <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>Body</span>.<span style=color:#a6e22e>Close</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Read the response body
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>body</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>ioutil</span>.<span style=color:#a6e22e>ReadAll</span>(<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>Body</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Parse the HTML content
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>doc</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>html</span>.<span style=color:#a6e22e>Parse</span>(<span style=color:#a6e22e>strings</span>.<span style=color:#a6e22e>NewReader</span>(string(<span style=color:#a6e22e>body</span>)))
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Connect to Elasticsearch
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>client</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>connectToElasticsearch</span>()
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>client</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;Unable to connect to Elasticsearch&#34;</span>)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Call the function to extract product data from the HTML
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>extractProductData</span>(<span style=color:#a6e22e>doc</span>, <span style=color:#a6e22e>client</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>In this function, we set the starting URL of our crawl, make an HTTP GET request to the URL, read the response body, and parse the HTML content using the &ldquo;html&rdquo; package. We then connect to Elasticsearch using the &ldquo;connectToElasticsearch&rdquo; function and call the &ldquo;extractProductData&rdquo; function to extract the product data from the HTML.</p><p>Next, let&rsquo;s define the &ldquo;extractProductData&rdquo; function:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>extractProductData</span>(<span style=color:#a6e22e>n</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>html</span>.<span style=color:#a6e22e>Node</span>, <span style=color:#a6e22e>client</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>elastic</span>.<span style=color:#a6e22e>Client</span>) {
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Check if the node is an element node
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>Type</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>html</span>.<span style=color:#a6e22e>ElementNode</span> {
</span></span><span style=display:flex><span>		<span style=color:#75715e>// Check if the element is a &#34;div&#34; with the class &#34;product&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>Data</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;div&#34;</span> {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>attr</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>Attr</span> {
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>attr</span>.<span style=color:#a6e22e>Key</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;class&#34;</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>attr</span>.<span style=color:#a6e22e>Val</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;product&#34;</span> {
</span></span><span style=display:flex><span>					<span style=color:#75715e>// Extract the product data from the element
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>					<span style=color:#a6e22e>product</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>extractProductDataFromElement</span>(<span style=color:#a6e22e>n</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>					<span style=color:#75715e>// Index the product data in Elasticsearch
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>					<span style=color:#a6e22e>indexProduct</span>(<span style=color:#a6e22e>product</span>, <span style=color:#a6e22e>client</span>)
</span></span><span style=display:flex><span>				}
</span></span><span style=display:flex><span>			}
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Recursively call the function for each child node
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>c</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>FirstChild</span>; <span style=color:#a6e22e>c</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span>; <span style=color:#a6e22e>c</span> = <span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>NextSibling</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>extractProductData</span>(<span style=color:#a6e22e>c</span>, <span style=color:#a6e22e>client</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>In this function, we use a recursive approach to traverse the HTML tree and search for &ldquo;div&rdquo; elements with the class &ldquo;product&rdquo;. Whenever we find such an element, we call the &ldquo;extractProductDataFromElement&rdquo; function to extract the product data from the element, and then call the &ldquo;indexProduct&rdquo; function to index the data in Elasticsearch.</p><p>Here is the &ldquo;extractProductDataFromElement&rdquo; function:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>extractProductDataFromElement</span>(<span style=color:#a6e22e>n</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>html</span>.<span style=color:#a6e22e>Node</span>) <span style=color:#f92672>*</span><span style=color:#a6e22e>Product</span> {
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Initialize a product struct
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>product</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>Product</span>{}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Traverse the children of the element
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>c</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>FirstChild</span>; <span style=color:#a6e22e>c</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span>; <span style=color:#a6e22e>c</span> {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Check if the child is an element node
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>Type</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>html</span>.<span style=color:#a6e22e>ElementNode</span> {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// Extract the product name
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>Data</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;h3&#34;</span> {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>for</span> <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>attr</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>Attr</span> {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>attr</span>.<span style=color:#a6e22e>Key</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;class&#34;</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>attr</span>.<span style=color:#a6e22e>Val</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;name&#34;</span> {
</span></span><span style=display:flex><span>                        <span style=color:#a6e22e>product</span>.<span style=color:#a6e22e>Name</span> = <span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>FirstChild</span>.<span style=color:#a6e22e>Data</span>
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#75715e>// Extract the product price
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>Data</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;span&#34;</span> {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>for</span> <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>attr</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>Attr</span> {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>attr</span>.<span style=color:#a6e22e>Key</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;class&#34;</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>attr</span>.<span style=color:#a6e22e>Val</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;price&#34;</span> {
</span></span><span style=display:flex><span>                        <span style=color:#a6e22e>product</span>.<span style=color:#a6e22e>Price</span> = <span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>FirstChild</span>.<span style=color:#a6e22e>Data</span>
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Return the product struct
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>product</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>In this function, we traverse the children of the element and extract the product name and price using the HTML tag names and class attributes. We then store the data in a &ldquo;Product&rdquo; struct and return it to the caller.</p><p>Finally, let&rsquo;s define the &ldquo;indexProduct&rdquo; function:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>indexProduct</span>(<span style=color:#a6e22e>product</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Product</span>, <span style=color:#a6e22e>client</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>elastic</span>.<span style=color:#a6e22e>Client</span>) {
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Index the product in Elasticsearch
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>client</span>.<span style=color:#a6e22e>Index</span>().
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Index</span>(<span style=color:#e6db74>&#34;products&#34;</span>).
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Type</span>(<span style=color:#e6db74>&#34;product&#34;</span>).
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Id</span>(<span style=color:#a6e22e>product</span>.<span style=color:#a6e22e>Name</span>).
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>BodyJson</span>(<span style=color:#a6e22e>product</span>).
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Do</span>(<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>Background</span>())
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Print a message to the console
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;Product indexed:&#34;</span>, <span style=color:#a6e22e>product</span>.<span style=color:#a6e22e>Name</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>In this function, we use the Elasticsearch client to index the product data in the &ldquo;products&rdquo; index and &ldquo;product&rdquo; type. We set the ID of the document to be the product name, and the body of the document to be the product struct.</p><p>Now that we have all of the functions defined, we can run our web crawler by calling the &ldquo;main&rdquo; function. The web crawler will make an HTTP request to the starting URL, parse the HTML content, extract the product data from the HTML, and index the data in Elasticsearch.</p><p>This is just a basic example of how to build a web crawler for Amazon.com using GoLang and store the data in Elasticsearch. With a little modification and customization, you can use this as a starting point to build a more sophisticated web crawler that meets your specific needs.</p></div></div></div></div></section></div><section class=footer id=contact><div class=footer__background_shape><svg viewBox="0 0 1920 79"><path d="M0 0h1920v79L0 0z" data-name="Path 1450"/></svg></div><div class=container><div class=row><div class=col-lg-12><div class=footer__cta><div class=shape-1><svg xmlns="http://www.w3.org/2000/svg" width="357" height="315.029" viewBox="0 0 357 315.029"><path data-name="Path 1449" d="M76.1-157.222C91.746-135.8 87.2-94.273 99.993-61.945c12.7 32.328 42.661 55.459 39.248 73.282-3.318 17.823-40.007 30.337-65.6 43.325-25.5 12.988-39.912 26.545-60.01 42.566-20.1 16.116-46.074 34.6-63.328 27.682-17.349-6.921-25.976-39.153-59.915-59.82s-93.1-29.768-105.325-51.478 22.373-56.028 43.609-93.949c21.331-37.921 29.2-79.35 53.563-96.793 24.459-17.444 65.414-10.9 103.9-6.921 38.396 3.982 74.326 5.404 89.965 26.829z" transform="translate(217.489 188.626)"/></svg></div><div class=shape-2><svg xmlns="http://www.w3.org/2000/svg" width="357" height="315.029" viewBox="0 0 357 315.029"><path data-name="Path 1449" d="M76.1-157.222C91.746-135.8 87.2-94.273 99.993-61.945c12.7 32.328 42.661 55.459 39.248 73.282-3.318 17.823-40.007 30.337-65.6 43.325-25.5 12.988-39.912 26.545-60.01 42.566-20.1 16.116-46.074 34.6-63.328 27.682-17.349-6.921-25.976-39.153-59.915-59.82s-93.1-29.768-105.325-51.478 22.373-56.028 43.609-93.949c21.331-37.921 29.2-79.35 53.563-96.793 24.459-17.444 65.414-10.9 103.9-6.921 38.396 3.982 74.326 5.404 89.965 26.829z" transform="translate(217.489 188.626)"/></svg></div><div class="text-light footer__cta_content"><span>Contact me</span><h2 class=mb-0>Let’s Start a Project</h2></div><div class=footer__cta_action><a class="btn btn-light btn-zoom" href=https://AceTheOps.com/contact>Get in
touch</a></div></div></div></div><div class="row footer__widget"><div class=col-lg-4><div class="footer__widget_logo mb-5"><img src=https://AceTheOps.com/images/contact/widget-logo.png style=width:400px alt=widget-logo></div></div><div class=col-lg-4 style=margin-left:100px><div class="text-light footer__widget_address mb-5"><h4 class=base-font>Sitemap</h4><ul class="unstyle-list small"><li class=mb-2><a class=text-light href=https://AceTheOps.com/about>About me</a></li><li class=mb-2><a class=text-light href=https://AceTheOps.com/>Frequently Ask Question</a></li><li class=mb-2><a class=text-light href=https://AceTheOps.com/>Privacy & Policy</a></li><li class=mb-2><a class=text-light href=https://AceTheOps.com/>Latest Article</a></li></ul><h4 class=base-font>Address</h4><ul class="fa-ul small"><li class=mb-2><a class=text-light href=tel:><span class=fa-li><i class="fa fa-phone"></i></span></a></li><li class=mb-2><a class=text-light href=mailto:aakriti@acetheops.com><span class=fa-li><i class="fa fa-envelope"></i></span>aakriti@acetheops.com</a></li><li class=mb-2><span class=fa-li><i class="fa fa-map-marker"></i></span>23 Khan Niketon, Grand Street, NYK.</a></li></ul></div></div></div><div class="row footer__footer"><div class=col-lg-6><div class="footer__footer_copy text-light"><p>Copyright 2023 - All Rights Reserved by <a class=text-light href=https://AceTheOps.com/ target=_blank>AceTheOps</a></p></div></div><div class=col-lg-6><div class=footer__footer_social><ul class=unstyle-list><li class="d-inline-block mx-2"><a class=text-light target=_blank href=https://www.facebook.com/><i class="fa fa-facebook-official"></i></a></li><li class="d-inline-block mx-2"><a class=text-light target=_blank href=https://www.linkedin.com/><i class="fa fa-linkedin-square"></i></a></li><li class="d-inline-block mx-2"><a class=text-light target=_blank href=https://www.pinterest.com/><i class="fa fa-pinterest-square"></i></a></li><li class="d-inline-block mx-2"><a class=text-light target=_blank href=https://twitter.com/><i class="fa fa-twitter-square"></i></a></li></ul></div></div></div></div></section><script src="https://maps.googleapis.com/maps/api/js?key=YOUR%20GOOGLE%20MAP%20API&libraries=geometry"></script>
<script src=https://AceTheOps.com/plugins/jQuery/jquery.min.js></script>
<script src=https://AceTheOps.com/plugins/bootstrap/bootstrap.min.js></script>
<script src=https://AceTheOps.com/plugins/slick/slick.min.js></script>
<script src=https://AceTheOps.com/plugins/waypoint/jquery.waypoints.min.js></script>
<script src=https://AceTheOps.com/plugins/magnafic-popup/jquery.magnific-popup.min.js></script>
<script src=https://AceTheOps.com/plugins/tweenmax/TweenMax.min.js></script>
<script src=https://AceTheOps.com/plugins/imagesloaded/imagesloaded.min.js></script>
<script src=https://AceTheOps.com/plugins/masonry/masonry.min.js></script>
<script src=https://AceTheOps.com/js/script.min.js></script></body></html>