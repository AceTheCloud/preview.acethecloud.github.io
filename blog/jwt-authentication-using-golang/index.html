<!doctype html><html><head><meta charset=utf-8><title>JWT Authentication using GoLang</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><link rel=stylesheet href=https://preview.acethecloud.com/plugins/slick/slick.css><link rel=stylesheet href=https://preview.acethecloud.com/plugins/slick/slick-theme.css><link rel=stylesheet href=https://preview.acethecloud.com/plugins/font-awesome/css/font-awesome.min.css><link rel=stylesheet href=https://preview.acethecloud.com/plugins/magnafic-popup/magnific-popup.css><link href=https://preview.acethecloud.com/scss/style.min.css rel=stylesheet><link rel="shortcut icon" href=https://preview.acethecloud.com/images/favicon.ico type=image/x-icon><link rel=icon href=https://preview.acethecloud.com/images/favicon.png type=image/x-icon><script async src="https://www.googletagmanager.com/gtag/js?id=G-FCQTR1NVY6"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-FCQTR1NVY6")</script></head><body><nav class="navbar navbar-expand-lg fixed-top"><div class=container><a href=https://preview.acethecloud.com/ class=navbar-brand><img src=https://preview.acethecloud.com/images/site-navigation/logo.png alt=site-logo></a>
<button type=button class="navbar-toggler collapsed" data-toggle=collapse data-target=#navbarCollapse>
<span class=navbar-toggler-icon></span>
<span class=navbar-toggler-icon></span>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse justify-content-between" id=navbarCollapse><ul class="nav navbar-nav main-navigation my-0 mx-auto"><li class=nav-item><a href=https://preview.acethecloud.com/#home class="nav-link text-dark text-sm-center p-2">Home</a></li><li class=nav-item><a href=https://preview.acethecloud.com/#about class="nav-link text-dark text-sm-center p-2">About</a></li><li class=nav-item><a href=https://preview.acethecloud.com/#resume class="nav-link text-dark text-sm-center p-2">Cloud</a></li><li class=nav-item><a href=https://preview.acethecloud.com/#skills class="nav-link text-dark text-sm-center p-2">Cloud Share</a></li><li class=nav-item><a href=https://preview.acethecloud.com/#contact class="nav-link text-dark text-sm-center p-2">Subscribe</a></li></ul><div class=navbar-nav><a href=https://preview.acethecloud.com/blog class="btn btn-primary btn-zoom hire_button">Blog</a></div></div></div></nav><div id=content><header class=breadCrumb><div class=container><div class=row><div class="col-lg-10 col-md-12 offset-lg-1 offset-md-0 text-center"><h3 class=breadCrumb__title>JWT Authentication using GoLang</h3><nav aria-label=breadcrumb class="d-flex justify-content-center"><ol class="breadcrumb align-items-center"><li class=breadcrumb-item><a href=https://preview.acethecloud.com/>Home</a></li><li class=breadcrumb-item><a href=https://preview.acethecloud.com/blog>All Post</a></li><li class="breadcrumb-item active" aria-current=page>JWT Authentication using GoLang</li></ol></nav></div></div><ul class=post-meta><li><i class="fa fa-calendar"></i>
December 2, 2022</li><li><i class="fa fa-clock-o"></i>
7 mins read</li><li><i class="fa fa-tag"></i>
<a class=text-capitalize href=https://preview.acethecloud.com/tags/go-lang/>go-lang</a>
<a class=text-capitalize href=https://preview.acethecloud.com/tags/web/>web</a>
<a class=text-capitalize href=https://preview.acethecloud.com/tags/microservices/>microservices</a>
<a class=text-capitalize href=https://preview.acethecloud.com/tags/authentication/>authentication</a>
<a class=text-capitalize href=https://preview.acethecloud.com/tags/security/>security</a></li><li><i class="fa fa-folder-open"></i>
<a class=text-capitalize href=https://preview.acethecloud.com/categories/blog/>blog</a></li></ul></div></div></div></div></header><section class="section singleBlog"><div class=svg-img><img src=https://preview.acethecloud.com/images/hero/figure-svg.svg alt></div><div class=animate-shape><img src=https://preview.acethecloud.com/images/skill/skill-background-shape.svg alt><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 600 600"><defs><linearGradient id="d" x1=".929" y1=".111" x2=".263" y2=".935" gradientUnits="objectBoundingBox"><stop offset="0" stop-color="#f1f6f9"/><stop offset="1" stop-color="#f1f6f9" stop-opacity="0"/></linearGradient></defs><g data-name="blob-shape (3)"><path class="blob" fill="url(#d)" d="M455.4 151.1c43.1 36.7 73.4 92.8 60.8 136.3-12.7 43.5-68.1 74.4-111.3 119.4-43.1 45-74 104.1-109.8 109-35.9 5-76.7-44.2-111.8-89.2-35.2-45-64.7-85.8-70.8-132.6-6-46.8 11.6-99.6 46.7-136.3 35.2-36.6 88-57.2 142.4-58.8 54.5-1.7 110.6 15.6 153.8 52.2z"/></g></svg></div><div class=animate-pattern><img src=https://preview.acethecloud.com/images/service/background-pattern.svg alt=background-shape></div><div class=container><div class=row><div class=col-lg-12><div class=singleBlog__feature><img src=https://preview.acethecloud.com/ alt=feature-image></div></div></div><div class="row mt-5"><div class=col-lg-12><div class=singleBlog__content><h3 id=what-is-jwt>What is JWT</h3><p>JSON Web Token (JWT) is a widely used standard for securely transmitting information between parties. It is commonly used to transmit information that can be verified and trusted, because it is digitally signed.</p><p>JWTs consist of three parts: a header, a payload, and a signature. The header typically consists of two parts: the type of the token, which is JWT, and the signing algorithm being used, such as HMAC SHA256 or RSA. The payload contains the claims. Claims are statements about an entity (typically, the user) and additional data. There are three types of claims: registered, public, and private claims. The signature is used to verify that the sender of the JWT is who it says it is and to ensure that the message wasn&rsquo;t changed along the way.</p><p>To create a JWT, you first need to create the header and payload, which are then encoded using base64url encoding. The resulting two strings are then concatenated, separated by a period (.). The final step is to create the signature by signing the concatenated string using the algorithm specified in the header.</p><p>When a JWT is received, it can be decoded and the signature can be verified to ensure that it was not tampered with. If the signature is valid, the claims in the payload can be trusted and used to grant access or perform other actions.</p><p>JWTs are commonly used for authentication and authorization purposes, because they allow the server to verify the identity of the client and grant access to protected resources. They are also used for securely transmitting information between parties, such as when exchanging information between microservices</p><h3 id=protecting-apis-using-jwt>Protecting APIs using JWT</h3><p>Here are some general steps you can follow to protect APIs using JSON Web Tokens (JWTs):</p><ol><li>Set up an authentication server:</li></ol><p>The first step is to set up an authentication server that is responsible for issuing and validating JWTs. This server should have a secure database to store user credentials and a way to authenticate users, such as by using username and password or by using third-party authentication providers like Google or Facebook.</p><ol start=2><li>Implement the login flow:</li></ol><p>To authenticate users, you need to implement a login flow that allows users to provide their credentials and receive a JWT in return. This typically involves sending a request to the authentication server with the user&rsquo;s credentials, and receiving a JWT in the response if the credentials are valid.</p><ol start=3><li>Secure your APIs:</li></ol><p>Once you have an authentication server set up and a login flow implemented, you can secure your APIs by requiring that clients provide a valid JWT in order to access them. This can be done by implementing a middleware or interceptor that checks for the presence of a JWT in the request header and verifies its signature and claims before allowing the request to proceed.</p><ol start=4><li>Refresh JWTs:</li></ol><p>JWTs have a limited lifespan, and will expire after a certain period of time. To ensure that users don&rsquo;t have to constantly log in, you can implement a refresh flow that allows users to request a new JWT when their current one expires. This can be done by sending a request to the authentication server with the expired JWT, and receiving a new JWT in the response.</p><p>By following these steps, you can use JWTs to secure your APIs and protect them from unauthorized access. It is important to keep in mind that JWTs are just one aspect of API security, and you should also consider implementing other measures such as input validation and rate limiting to ensure the security of your APIs.</p><h4 id=golang-code-to-implement-jwt-based-authentication>GoLang Code to implement JWT based Authentication</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;log&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;net/http&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;github.com/dgrijalva/jwt-go&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;github.com/gorilla/context&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;github.com/gorilla/mux&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Create a struct that will be encoded to a JWT.
</span></span></span><span style=display:flex><span><span style=color:#75715e>// We add jwt.StandardClaims as an embedded type, to provide fields like expiry time
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Claims</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Username</span> <span style=color:#66d9ef>string</span> <span style=color:#e6db74>`json:&#34;username&#34;`</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>jwt</span>.<span style=color:#a6e22e>StandardClaims</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Create a signup handler
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>SignupHandler</span>(<span style=color:#a6e22e>w</span> <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>ResponseWriter</span>, <span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Request</span>) {
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Get the username and password from the request body
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>username</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>FormValue</span>(<span style=color:#e6db74>&#34;username&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>password</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>FormValue</span>(<span style=color:#e6db74>&#34;password&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Check if the username and password are valid
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>username</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>password</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;&#34;</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Error</span>(<span style=color:#a6e22e>w</span>, <span style=color:#e6db74>&#34;Username or password is empty&#34;</span>, <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>StatusBadRequest</span>)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Create a new JWT token
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>expiryTime</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Now</span>().<span style=color:#a6e22e>Add</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Hour</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>24</span>).<span style=color:#a6e22e>Unix</span>() <span style=color:#75715e>// 24 hours
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>claims</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>Claims</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Username</span>: <span style=color:#a6e22e>username</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>StandardClaims</span>: <span style=color:#a6e22e>jwt</span>.<span style=color:#a6e22e>StandardClaims</span>{
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>ExpiresAt</span>: <span style=color:#a6e22e>expiryTime</span>,
</span></span><span style=display:flex><span>		},
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>token</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>jwt</span>.<span style=color:#a6e22e>NewWithClaims</span>(<span style=color:#a6e22e>jwt</span>.<span style=color:#a6e22e>SigningMethodHS256</span>, <span style=color:#a6e22e>claims</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Sign and get the complete encoded token as a string
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>signedToken</span>, <span style=color:#a6e22e>_</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>token</span>.<span style=color:#a6e22e>SignedString</span>([]byte(<span style=color:#e6db74>&#34;secret&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Save the token to the database
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#75715e>// (omitted in this example)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Send the signed token to the client
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>Write</span>([]byte(<span style=color:#a6e22e>signedToken</span>))
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Create a login handler
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>LoginHandler</span>(<span style=color:#a6e22e>w</span> <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>ResponseWriter</span>, <span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Request</span>) {
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Get the username and password from the request body
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>username</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>FormValue</span>(<span style=color:#e6db74>&#34;username&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>password</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>FormValue</span>(<span style=color:#e6db74>&#34;password&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Check if the username and password are valid
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>username</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>password</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;&#34;</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Error</span>(<span style=color:#a6e22e>w</span>, <span style=color:#e6db74>&#34;Username or password is empty&#34;</span>, <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>StatusBadRequest</span>)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Check if the username and password are correct
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#75715e>// (omitted in this example)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Create a new JWT token
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>expiryTime</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Now</span>().<span style=color:#a6e22e>Add</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Hour</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>24</span>).<span style=color:#a6e22e>Unix</span>() <span style=color:#75715e>// 24 hours
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>claims</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>Claims</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Username</span>: <span style=color:#a6e22e>username</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>StandardClaims</span>: <span style=color:#a6e22e>jwt</span>.<span style=color:#a6e22e>StandardClaims</span>{
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>ExpiresAt</span>: <span style=color:#a6e22e>expiryTime</span>,
</span></span><span style=display:flex><span>		},
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>token</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>jwt</span>.<span style=color:#a6e22e>NewWithClaims</span>(<span style=color:#a6e22e>jwt</span>.<span style=color:#a6e22e>SigningMethodHS256</span>, <span style=color:#a6e22e>claims</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Sign and get the complete encoded token as a string
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>signedToken</span>, <span style=color:#a6e22e>_</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>token</span>.<span style=color:#a6e22e>SignedString</span>([]byte(<span style=color:#e6db74>&#34;secret&#34;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Send the signed token to the client
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>Write</span>([]byte(<span style=color:#a6e22e>signedToken</span>))
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=creating-a-protected-handler-that-can-only-be-accessed-with-a-valid-jwt>Creating a protected handler that can only be accessed with a valid JWT</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span><span style=color:#75715e>// Create a protected handler
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>ProtectedHandler</span>(<span style=color:#a6e22e>w</span> <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>ResponseWriter</span>, <span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Request</span>) {
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Get the JWT from the request header
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>authHeader</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>Header</span>.<span style=color:#a6e22e>Get</span>(<span style=color:#e6db74>&#34;Authorization&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>authHeader</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;&#34;</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Error</span>(<span style=color:#a6e22e>w</span>, <span style=color:#e6db74>&#34;Missing authorization header&#34;</span>, <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>StatusUnauthorized</span>)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Extract the JWT from the authorization header
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>tokenString</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>strings</span>.<span style=color:#a6e22e>TrimPrefix</span>(<span style=color:#a6e22e>authHeader</span>, <span style=color:#e6db74>&#34;Bearer &#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>tokenString</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;&#34;</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Error</span>(<span style=color:#a6e22e>w</span>, <span style=color:#e6db74>&#34;Invalid authorization header&#34;</span>, <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>StatusUnauthorized</span>)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Parse the JWT
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>token</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>jwt</span>.<span style=color:#a6e22e>ParseWithClaims</span>(<span style=color:#a6e22e>tokenString</span>, <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>Claims</span>{}, <span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>token</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>jwt</span>.<span style=color:#a6e22e>Token</span>) (<span style=color:#66d9ef>interface</span>{}, <span style=color:#66d9ef>error</span>) {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> []byte(<span style=color:#e6db74>&#34;secret&#34;</span>), <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>	})
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Error</span>(<span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>err</span>.<span style=color:#a6e22e>Error</span>(), <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>StatusUnauthorized</span>)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Check if the JWT is valid
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>if</span> !<span style=color:#a6e22e>token</span>.<span style=color:#a6e22e>Valid</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Error</span>(<span style=color:#a6e22e>w</span>, <span style=color:#e6db74>&#34;Invalid JWT&#34;</span>, <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>StatusUnauthorized</span>)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Get the claims from the JWT
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>claims</span>, <span style=color:#a6e22e>ok</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>token</span>.<span style=color:#a6e22e>Claims</span>.(<span style=color:#f92672>*</span><span style=color:#a6e22e>Claims</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> !<span style=color:#a6e22e>ok</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Error</span>(<span style=color:#a6e22e>w</span>, <span style=color:#e6db74>&#34;Invalid JWT claims&#34;</span>, <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>StatusUnauthorized</span>)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Use the claims to do something, for example, get the username from the claims
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>username</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>claims</span>.<span style=color:#a6e22e>Username</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Write a response to the client
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#a6e22e>w</span>.<span style=color:#a6e22e>Write</span>([]byte(<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Sprintf</span>(<span style=color:#e6db74>&#34;Hello, %s&#34;</span>, <span style=color:#a6e22e>username</span>)))
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>This protected handler first gets the JWT from the &lsquo;Authorization&rsquo; header of the request.
It then parses the JWT and verifies that it is valid. If the JWT is valid, the handler extracts the claims from the JWT and uses them to do something, for example, getting the username from the claims. If the JWT is invalid or there is any error during the parsing or verification process, the handler returns an error to the client.</p><p><strong>Here are a few things to consider when building an authentication server:</strong></p><p><strong>Security:</strong>
Make sure to use secure methods for storing and transmitting passwords, such as hashing and salting. Use secure communication channels, such as HTTPS, to prevent attackers from intercepting sensitive information.</p><p><strong>Scalability:</strong>
Consider the performance and scalability of your authentication server. Make sure that it can handle a large number of requests without breaking down.</p><p><strong>API design:</strong>
Design your API in a way that is easy to use and understand. Consider the use cases for your API and design it accordingly.</p><p><strong>Error handling:</strong>
Properly handle errors and return appropriate status codes and error messages to the client.</p><p><strong>Documentation:</strong>
Provide clear and comprehensive documentation for your API, including examples of how to use it and any relevant details about authentication and authorization.</p><p><strong>Testing:</strong>
Test your authentication server thoroughly to ensure that it is reliable and secure.</p><p><strong>Updates and maintenance:</strong>
Keep your authentication server up to date with the latest security patches and updates. Regularly monitor and maintain it to ensure that it continues to function as expected.</p></div></div></div></div></section></div><section class=footer id=contact><div class=footer__background_shape><svg viewBox="0 0 1920 79"><path d="M0 0h1920v79L0 0z" data-name="Path 1450"/></svg></div><div class=container><div class=row><div class=col-lg-12><div class=footer__cta><div class=shape-1><svg xmlns="http://www.w3.org/2000/svg" width="357" height="315.029" viewBox="0 0 357 315.029"><path data-name="Path 1449" d="M76.1-157.222C91.746-135.8 87.2-94.273 99.993-61.945c12.7 32.328 42.661 55.459 39.248 73.282-3.318 17.823-40.007 30.337-65.6 43.325-25.5 12.988-39.912 26.545-60.01 42.566-20.1 16.116-46.074 34.6-63.328 27.682-17.349-6.921-25.976-39.153-59.915-59.82s-93.1-29.768-105.325-51.478 22.373-56.028 43.609-93.949c21.331-37.921 29.2-79.35 53.563-96.793 24.459-17.444 65.414-10.9 103.9-6.921 38.396 3.982 74.326 5.404 89.965 26.829z" transform="translate(217.489 188.626)"/></svg></div><div class=shape-2><svg xmlns="http://www.w3.org/2000/svg" width="357" height="315.029" viewBox="0 0 357 315.029"><path data-name="Path 1449" d="M76.1-157.222C91.746-135.8 87.2-94.273 99.993-61.945c12.7 32.328 42.661 55.459 39.248 73.282-3.318 17.823-40.007 30.337-65.6 43.325-25.5 12.988-39.912 26.545-60.01 42.566-20.1 16.116-46.074 34.6-63.328 27.682-17.349-6.921-25.976-39.153-59.915-59.82s-93.1-29.768-105.325-51.478 22.373-56.028 43.609-93.949c21.331-37.921 29.2-79.35 53.563-96.793 24.459-17.444 65.414-10.9 103.9-6.921 38.396 3.982 74.326 5.404 89.965 26.829z" transform="translate(217.489 188.626)"/></svg></div><div class="text-light footer__cta_content"><span>Contact me</span><h3 class=mb-0>Let’s Discuss on your Cloud Journey</h3></div><div class=footer__cta_action><a class="btn btn-light btn-zoom" href=https://preview.acethecloud.com/contact>Get in
touch</a></div></div></div></div><div class="row footer__widget"><div class=col-lg-4><div class="footer__widget_logo mb-5"><img src=https://preview.acethecloud.com/images/contact/widget-logo.png style=width:400px alt=widget-logo></div></div><div class=col-lg-4 style=margin-left:100px><div class="text-light footer__widget_address mb-5"><h4 class=base-font>Sitemap</h4><ul class="unstyle-list small"><li class=mb-2><a class=text-light href=https://preview.acethecloud.com/about>About Author</a></li><li class=mb-2><a class=text-light href=https://preview.acethecloud.com/>Frequently Ask Question</a></li><li class=mb-2><a class=text-light href=https://preview.acethecloud.com/>Privacy & Policy</a></li><li class=mb-2><a class=text-light href=https://preview.acethecloud.com/>Latest Article</a></li></ul><h4 class=base-font>Address</h4><ul class="fa-ul small"><li class=mb-2><a class=text-light href=tel:><span class=fa-li><i class="fa fa-phone"></i></span></a></li><li class=mb-2><a class=text-light href=mailto:><span class=fa-li><i class="fa fa-envelope"></i></span></a></li><li class=mb-2><span class=fa-li><i class="fa fa-map-marker"></i></span></a></li></ul></div></div></div><div class="row footer__footer"><div class=col-lg-6><div class="footer__footer_copy text-light"><p>Copyright 2023 - All Rights Reserved by <a class=text-light href=https://AceTheOps.com/ target=_blank>AceTheOps</a></p></div></div><div class=col-lg-6><div class=footer__footer_social><ul class=unstyle-list><li class="d-inline-block mx-2"><a class=text-light target=_blank href=https://www.facebook.com/><i class="fa fa-facebook-official"></i></a></li><li class="d-inline-block mx-2"><a class=text-light target=_blank href=https://www.linkedin.com/><i class="fa fa-linkedin-square"></i></a></li><li class="d-inline-block mx-2"><a class=text-light target=_blank href=https://www.pinterest.com/><i class="fa fa-pinterest-square"></i></a></li><li class="d-inline-block mx-2"><a class=text-light target=_blank href=https://twitter.com/AceTheCloud><i class="fa fa-twitter-square"></i></a></li></ul></div></div></div></div></section><script src="https://maps.googleapis.com/maps/api/js?key=&libraries=geometry"></script>
<script src=https://preview.acethecloud.com/plugins/jQuery/jquery.min.js></script>
<script src=https://preview.acethecloud.com/plugins/bootstrap/bootstrap.min.js></script>
<script src=https://preview.acethecloud.com/plugins/slick/slick.min.js></script>
<script src=https://preview.acethecloud.com/plugins/waypoint/jquery.waypoints.min.js></script>
<script src=https://preview.acethecloud.com/plugins/magnafic-popup/jquery.magnific-popup.min.js></script>
<script src=https://preview.acethecloud.com/plugins/tweenmax/TweenMax.min.js></script>
<script src=https://preview.acethecloud.com/plugins/imagesloaded/imagesloaded.min.js></script>
<script src=https://preview.acethecloud.com/plugins/masonry/masonry.min.js></script>
<script src=https://preview.acethecloud.com/js/script.min.js></script></body></html>